# üß™ TribeCore HR - Testing Guide

## üìã **Testing Checklist**

This guide provides comprehensive test scenarios for all Phase 5 features.

---

## üîê **1. AUTHENTICATION & RBAC TESTING**

### **Test 1.1: User Registration**

**Steps:**
1. Go to `/register`
2. Fill in registration form:
   - Email: `test@example.com`
   - Password: `SecurePass123!`
   - First Name: `Test`
   - Last Name: `User`
3. Click "Register"

**Expected Result:**
- ‚úÖ User is created
- ‚úÖ Redirected to dashboard
- ‚úÖ User has default role: `EMPLOYEE`

### **Test 1.2: User Login**

**Steps:**
1. Go to `/login`
2. Enter credentials
3. Click "Login"

**Expected Result:**
- ‚úÖ JWT token received
- ‚úÖ Redirected to dashboard
- ‚úÖ User name displayed in header

### **Test 1.3: Role-Based Access**

**Create test users with different roles:**

```sql
-- In your database
UPDATE users SET roles = ARRAY['EMPLOYEE'] WHERE email = 'employee@test.com';
UPDATE users SET roles = ARRAY['MANAGER'] WHERE email = 'manager@test.com';
UPDATE users SET roles = ARRAY['HR_MANAGER'] WHERE email = 'hr@test.com';
UPDATE users SET roles = ARRAY['ADMIN'] WHERE email = 'admin@test.com';
UPDATE users SET roles = ARRAY['SUPER_ADMIN'] WHERE email = 'superadmin@test.com';
```

**Test as EMPLOYEE:**
- ‚úÖ Can view own absence balances
- ‚úÖ Can request absence
- ‚úÖ Can view own tasks
- ‚úÖ Cannot view team tasks
- ‚ùå Cannot approve absences

**Test as MANAGER:**
- ‚úÖ Can view team absences
- ‚úÖ Can approve/reject team requests
- ‚úÖ Can view team tasks
- ‚úÖ Can assign tasks to team
- ‚ùå Cannot view org-wide data

**Test as HR_MANAGER:**
- ‚úÖ Can view all absences
- ‚úÖ Can configure absence plans
- ‚úÖ Can verify bank details
- ‚úÖ Can view all employees
- ‚ùå Cannot manage system permissions

**Test as SUPER_ADMIN:**
- ‚úÖ Has access to everything
- ‚úÖ Can manage permissions
- ‚úÖ Can configure dashboard widgets
- ‚úÖ Can impersonate users

---

## üìÖ **2. ABSENCE MANAGEMENT TESTING**

### **Test 2.1: View Absence Plans**

**Steps:**
1. Login as any user
2. Go to `/absence`
3. View absence plans

**Expected Result:**
- ‚úÖ 5 plans displayed: Holiday, Birthday, Level-Up, Sickness, Other
- ‚úÖ Each plan shows description and entitlement

### **Test 2.2: View Absence Balances**

**Steps:**
1. Go to `/absence`
2. View balance cards

**Expected Result:**
- ‚úÖ Balances shown for each plan
- ‚úÖ Shows: Entitlement, Taken, Pending, Remaining
- ‚úÖ Color-coded by plan type

### **Test 2.3: Request Absence - Success**

**Steps:**
1. Go to `/absence`
2. Click "Request Absence"
3. Select plan: "Holiday 2026 Plan"
4. Select start date: Tomorrow
5. Select end date: 3 days from tomorrow
6. Add notes: "Family vacation"
7. Click "Submit Request"

**Expected Result:**
- ‚úÖ Request created with status "PENDING"
- ‚úÖ Pending days increased in balance
- ‚úÖ Available days decreased
- ‚úÖ Request appears in list
- ‚úÖ Success toast notification shown

### **Test 2.4: Request Absence - Insufficient Balance**

**Steps:**
1. Request 100 days of holiday
2. Submit

**Expected Result:**
- ‚úÖ Conflict detected: "EXCEEDS_BALANCE"
- ‚úÖ Request still created (with warning)
- ‚úÖ Error message shown

### **Test 2.5: Request Absence - Overlapping Dates**

**Steps:**
1. Create first request: Jan 1-5
2. Create second request: Jan 3-7

**Expected Result:**
- ‚úÖ Conflict detected: "OVERLAP"
- ‚ùå Request rejected or flagged

### **Test 2.6: Cancel Absence Request**

**Steps:**
1. Create a pending request
2. Click "Cancel" on the request
3. Confirm cancellation

**Expected Result:**
- ‚úÖ Request status changed to "CANCELLED"
- ‚úÖ Pending days decreased in balance
- ‚úÖ Available days increased
- ‚úÖ Success toast shown

### **Test 2.7: Approve Absence Request (Manager)**

**Steps:**
1. Login as MANAGER
2. Go to manager dashboard (to be implemented in future)
3. Or use API:
```bash
curl -X POST https://YOUR-API/api/v1/absence/requests/REQUEST_ID/approve \
  -H "Authorization: Bearer MANAGER_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"comment": "Approved - enjoy!"}'
```

**Expected Result:**
- ‚úÖ Request status changed to "APPROVED"
- ‚úÖ Pending days decreased
- ‚úÖ Scheduled days increased
- ‚úÖ Remaining days decreased
- ‚úÖ Calendar event created (future feature)
- ‚úÖ Notification sent (future feature)

### **Test 2.8: Reject Absence Request (Manager)**

**Steps:**
1. Login as MANAGER
2. Reject request with reason
```bash
curl -X POST https://YOUR-API/api/v1/absence/requests/REQUEST_ID/reject \
  -H "Authorization: Bearer MANAGER_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"reason": "Team is at capacity", "comment": "Please try another date"}'
```

**Expected Result:**
- ‚úÖ Request status changed to "REJECTED"
- ‚úÖ Pending days decreased
- ‚úÖ Available days increased (balance restored)
- ‚úÖ Rejection reason stored

### **Test 2.9: Sickness Episode**

**Steps:**
1. Create sickness episode
```bash
curl -X POST https://YOUR-API/api/v1/absence/sickness \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "startDate": "2025-01-15",
    "endDate": "2025-01-17",
    "sicknessType": "GENERAL",
    "reason": "Flu",
    "symptoms": "Fever, cough"
  }'
```

**Expected Result:**
- ‚úÖ Episode created
- ‚úÖ Episode count incremented
- ‚úÖ If 3rd episode in 12 months ‚Üí trigger RTW interview task

---

## ‚úÖ **3. TASK MANAGEMENT TESTING**

### **Test 3.1: View Tasks**

**Steps:**
1. Go to `/tasks`
2. View tasks list

**Expected Result:**
- ‚úÖ Tasks displayed in cards
- ‚úÖ Shows: title, status, priority, due date
- ‚úÖ Filters work (All, Incomplete, Completed)
- ‚úÖ Tabs work (All, Process, Checklist)

### **Test 3.2: Complete Task**

**Steps:**
1. Go to `/tasks`
2. Click on a pending task card
3. Task is marked as completed

**Expected Result:**
- ‚úÖ Task status changes to "COMPLETED"
- ‚úÖ Completed timestamp recorded
- ‚úÖ Task event logged
- ‚úÖ Success toast shown

### **Test 3.3: Create Task (Manager)**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/tasks \
  -H "Authorization: Bearer MANAGER_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Review Q1 Performance",
    "description": "Complete performance review for team member",
    "type": "PERFORMANCE_REVIEW",
    "priority": "HIGH",
    "assigneeId": "USER_ID",
    "dueDate": "2025-02-01"
  }'
```

**Expected Result:**
- ‚úÖ Task created
- ‚úÖ Assigned to user
- ‚úÖ Task event logged (CREATED)
- ‚úÖ Notification sent to assignee (future feature)

### **Test 3.4: Reassign Task (Manager)**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/tasks/TASK_ID/reassign \
  -H "Authorization: Bearer MANAGER_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"assigneeId": "NEW_USER_ID"}'
```

**Expected Result:**
- ‚úÖ Task assigned to new user
- ‚úÖ Task event logged (REASSIGNED)
- ‚úÖ Previous assignee notified (future feature)
- ‚úÖ New assignee notified (future feature)

### **Test 3.5: Create Checklist (Admin)**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/checklists \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "New Employee Onboarding",
    "description": "Standard onboarding checklist",
    "category": "ONBOARDING",
    "isTemplate": true,
    "items": [
      {
        "title": "Send welcome email",
        "description": "Include login credentials",
        "sequence": 1,
        "isRequired": true
      },
      {
        "title": "Provide laptop and equipment",
        "sequence": 2,
        "isRequired": true,
        "dueInDays": 1
      },
      {
        "title": "Schedule first 1:1 meeting",
        "sequence": 3,
        "isRequired": true,
        "dueInDays": 7
      }
    ]
  }'
```

**Expected Result:**
- ‚úÖ Checklist template created
- ‚úÖ 3 items created with sequence
- ‚úÖ Total items count = 3
- ‚úÖ Completion percentage = 0%

### **Test 3.6: Complete Checklist Item**

**Steps:**
```bash
curl -X PATCH https://YOUR-API/api/v1/checklist-items/ITEM_ID \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "isCompleted": true,
    "completionNotes": "Email sent successfully"
  }'
```

**Expected Result:**
- ‚úÖ Item marked as completed
- ‚úÖ Completed timestamp recorded
- ‚úÖ Checklist completion % updated (33%)

---

## üìä **4. DASHBOARD & SAVED SEARCHES TESTING**

### **Test 4.1: Create Saved Search**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/dashboard/saved-searches \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Pending Absences",
    "description": "All pending absence requests",
    "category": "ABSENCES",
    "scope": "PRIVATE",
    "query": {
      "filters": [
        {"field": "status", "operator": "eq", "value": "PENDING"}
      ],
      "sort": [
        {"field": "createdAt", "direction": "DESC"}
      ]
    }
  }'
```

**Expected Result:**
- ‚úÖ Search saved
- ‚úÖ Usage count = 0
- ‚úÖ Appears in user's saved searches list

### **Test 4.2: Execute Saved Search**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/dashboard/saved-searches/SEARCH_ID/execute \
  -H "Authorization: Bearer TOKEN"
```

**Expected Result:**
- ‚úÖ Usage count incremented
- ‚úÖ Last used timestamp updated
- ‚úÖ Search results returned

### **Test 4.3: Share Saved Search**

**Steps:**
```bash
curl -X PATCH https://YOUR-API/api/v1/dashboard/saved-searches/SEARCH_ID \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "scope": "TEAM",
    "sharedWithUserIds": ["USER_ID_1", "USER_ID_2"]
  }'
```

**Expected Result:**
- ‚úÖ Scope changed to TEAM
- ‚úÖ Specific users can access
- ‚úÖ Search appears in shared searches for those users

---

## üí≥ **5. BANK DETAILS TESTING**

### **Test 5.1: Add Bank Details**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/profile/bank-details \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "accountHolderName": "John Doe",
    "accountNumber": "12345678",
    "sortCode": "12-34-56",
    "accountType": "CHECKING",
    "bankName": "Test Bank",
    "country": "UK",
    "currency": "GBP",
    "isPrimary": true,
    "consentGiven": true
  }'
```

**Expected Result:**
- ‚úÖ Bank details created
- ‚úÖ Verification status: UNVERIFIED
- ‚úÖ Set as primary account
- ‚úÖ Consent timestamp recorded

### **Test 5.2: Verify Bank Details (HR)**

**Steps:**
```bash
curl -X POST https://YOUR-API/api/v1/profile/bank-details/admin/verify \
  -H "Authorization: Bearer HR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "bankDetailsId": "BANK_ID",
    "verificationNotes": "Verified with bank letter"
  }'
```

**Expected Result:**
- ‚úÖ Status changed to VERIFIED
- ‚úÖ Verified by user ID recorded
- ‚úÖ Verification timestamp recorded
- ‚úÖ Notes saved

---

## üîí **6. PERMISSION & SECURITY TESTING**

### **Test 6.1: Permission Check - Employee Cannot Approve**

**Steps:**
1. Login as EMPLOYEE
2. Try to approve absence request:
```bash
curl -X POST https://YOUR-API/api/v1/absence/requests/REQUEST_ID/approve \
  -H "Authorization: Bearer EMPLOYEE_TOKEN"
```

**Expected Result:**
- ‚ùå 403 Forbidden
- ‚ùå Error: "Insufficient permissions"

### **Test 6.2: Permission Check - Manager Can Approve Team**

**Steps:**
1. Login as MANAGER
2. Approve team member's request
```bash
curl -X POST https://YOUR-API/api/v1/absence/requests/REQUEST_ID/approve \
  -H "Authorization: Bearer MANAGER_TOKEN"
```

**Expected Result:**
- ‚úÖ 200 OK
- ‚úÖ Request approved

### **Test 6.3: Permission Check - Manager Cannot Approve Other Teams**

**Steps:**
1. Login as MANAGER
2. Try to approve request from different team

**Expected Result:**
- ‚ùå 403 Forbidden
- ‚ùå Error: "Access denied - outside your team scope"

---

## üì± **7. FRONTEND UI TESTING**

### **Test 7.1: Task Centre Page**

**Navigation:**
- ‚úÖ Click "Tasks" in sidebar
- ‚úÖ Page loads at `/tasks`
- ‚úÖ Task Centre header visible

**Tabs:**
- ‚úÖ "All Tasks" tab shows all tasks
- ‚úÖ "Process Tasks" tab filters by process type
- ‚úÖ "Checklist Tasks" tab filters by checklist type

**Filters:**
- ‚úÖ "All" button shows all statuses
- ‚úÖ "Incomplete" button hides completed tasks
- ‚úÖ "Completed" button shows only completed

**Task Cards:**
- ‚úÖ Priority icon displayed (urgent = red)
- ‚úÖ Status badge color-coded
- ‚úÖ Requester name shown
- ‚úÖ Task type label shown
- ‚úÖ Created date formatted correctly
- ‚úÖ Due date shown (if exists)

**Interactions:**
- ‚úÖ Click task card ‚Üí completes task
- ‚úÖ Success toast shown
- ‚úÖ Task moves to completed
- ‚úÖ Status badge updates

### **Test 7.2: Absence Requests Page**

**Navigation:**
- ‚úÖ Click "Absence" in sidebar
- ‚úÖ Page loads at `/absence`
- ‚úÖ Absence Requests header visible

**Balance Cards:**
- ‚úÖ 4 cards displayed (if 4 active plans)
- ‚úÖ Each card shows plan name
- ‚úÖ Color dot matches plan type
- ‚úÖ Entitlement, Taken, Pending, Remaining shown
- ‚úÖ Numbers formatted correctly

**Request List:**
- ‚úÖ Requests displayed in list
- ‚úÖ Status badge color-coded
- ‚úÖ Date range formatted
- ‚úÖ Days count shown
- ‚úÖ Notes displayed (if exists)
- ‚úÖ "Cancel" button shown for pending requests

**Request Modal:**
- ‚úÖ Click "Request Absence" ‚Üí modal opens
- ‚úÖ Plan dropdown populated
- ‚úÖ Select plan ‚Üí shows available balance
- ‚úÖ Date pickers work
- ‚úÖ Notes textarea accepts input
- ‚úÖ Submit ‚Üí request created
- ‚úÖ Cancel ‚Üí modal closes
- ‚úÖ Success toast shown on submit

**Error Handling:**
- ‚úÖ Missing required fields ‚Üí error toast
- ‚úÖ API error ‚Üí error toast with message
- ‚úÖ Loading states shown during API calls

### **Test 7.3: Profile Page**

**Navigation:**
- ‚úÖ Click "My Profile" in sidebar
- ‚úÖ Page loads at `/profile/me`

**Edit Functionality:**
- ‚úÖ Click "Edit Profile" ‚Üí navigates to `/profile/details`
- ‚úÖ Click "Edit Bio" ‚Üí textarea appears
- ‚úÖ Type in bio ‚Üí text updates
- ‚úÖ Click "Save" ‚Üí success toast
- ‚úÖ Click "Cancel" ‚Üí reverts changes

**Profile Details:**
- ‚úÖ All tabs functional (Personal, Employment, Contacts, Dependants)
- ‚úÖ Click "Edit" ‚Üí fields become editable
- ‚úÖ Fields update when typing
- ‚úÖ Click "Save Changes" ‚Üí success toast
- ‚úÖ Click "Cancel" ‚Üí exits edit mode

**Add Contact:**
- ‚úÖ Click "Add Contact" ‚Üí modal opens
- ‚úÖ Fill form ‚Üí fields work
- ‚úÖ Click "Add Contact" ‚Üí success toast
- ‚úÖ Modal closes

**Add Dependant:**
- ‚úÖ Click "Add Dependant" ‚Üí modal opens
- ‚úÖ Fill form ‚Üí fields work
- ‚úÖ Click "Add Dependant" ‚Üí success toast
- ‚úÖ Modal closes

---

## üö® **8. ERROR HANDLING TESTING**

### **Test 8.1: Network Errors**

**Steps:**
1. Disconnect network
2. Try to load tasks page

**Expected Result:**
- ‚úÖ Error toast: "Failed to load tasks"
- ‚úÖ Empty state shown
- ‚úÖ No crash

### **Test 8.2: Invalid JWT Token**

**Steps:**
1. Manually edit JWT in localStorage
2. Try to make API call

**Expected Result:**
- ‚úÖ 401 Unauthorized
- ‚úÖ Redirected to login page
- ‚úÖ Token cleared

### **Test 8.3: Validation Errors**

**Steps:**
1. Submit absence request with end date before start date

**Expected Result:**
- ‚úÖ Error toast shown
- ‚úÖ Validation message clear
- ‚úÖ Form not submitted

---

## üìä **9. PERFORMANCE TESTING**

### **Test 9.1: Page Load Times**

**Expected:**
- ‚úÖ Dashboard: < 2 seconds
- ‚úÖ Tasks page: < 2 seconds
- ‚úÖ Absence page: < 3 seconds (loads balances + requests)
- ‚úÖ Profile page: < 2 seconds

### **Test 9.2: API Response Times**

**Expected:**
- ‚úÖ GET endpoints: < 500ms
- ‚úÖ POST endpoints: < 1 second
- ‚úÖ Approval workflow: < 1.5 seconds

---

## ‚úÖ **TEST SUMMARY CHECKLIST**

### **Authentication & RBAC**
- [ ] Registration works
- [ ] Login works
- [ ] Role-based access enforced
- [ ] Permissions guard working

### **Absence Management**
- [ ] View plans works
- [ ] View balances works
- [ ] Request absence works
- [ ] Cancel request works
- [ ] Approve request works (manager)
- [ ] Reject request works (manager)
- [ ] Conflict detection works
- [ ] Balance updates correctly

### **Task Management**
- [ ] View tasks works
- [ ] Complete task works
- [ ] Create task works (manager)
- [ ] Reassign task works (manager)
- [ ] Checklist creation works (admin)
- [ ] Checklist item completion works
- [ ] Audit trail recorded

### **Dashboard**
- [ ] Create saved search works
- [ ] Execute search works
- [ ] Share search works
- [ ] Widget configuration works (admin)

### **Bank Details**
- [ ] Add bank details works
- [ ] Verify works (HR)
- [ ] Consent tracked

### **Frontend**
- [ ] All pages load
- [ ] All navigation links work
- [ ] All forms submit
- [ ] All modals open/close
- [ ] Error handling works
- [ ] Loading states shown

---

## üéØ **REGRESSION TESTING**

After each deployment, test:

1. ‚úÖ Login/logout flow
2. ‚úÖ Profile editing (existing feature)
3. ‚úÖ Calendar viewing (existing feature)
4. ‚úÖ New tasks page
5. ‚úÖ New absence page
6. ‚úÖ All navigation links

---

**Testing completed:** [  /  /2025]  
**Tested by:** _______________  
**Issues found:** _______________  
**Status:** [ ] Pass [ ] Fail

---

**Last Updated:** 2025-10-11
